{"version":3,"file":"js/123.ae579835.js","mappings":"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","sources":["webpack://online-shop/./src/stores/orderStore.js","webpack://online-shop/./src/stores/statusStore.js","webpack://online-shop/./src/views/user-views/UserOrderSearch.vue","webpack://online-shop/./src/views/user-views/UserOrderSearch.vue?3b3d"],"sourcesContent":["import { defineStore } from 'pinia';\nimport axios from 'axios';\nimport statusStore from './statusStore';\n\nconst status = statusStore();\n\nexport default defineStore('orderStore', {\n  state: () => ({\n    orders: [],\n    orderIsPaid: false,\n    orderId: '',\n    order: {\n      user: {},\n    },\n    shippingFee: 100,\n    isUseCoupon: false,\n    couponCode: '',\n    couponPercent: 100,\n    subTotal: 0,\n    creditNumError: false,\n    cvvNumError: false,\n    accNumError: false,\n    searchMessage: false,\n  }),\n  actions: {\n    getOrder(orderId) {\n      this.orderId = orderId;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order/${orderId}`;\n      status.isLoading = true;\n      axios\n        .get(api)\n        .then((response) => {\n          status.isLoading = false;\n          if (response.data.success && response.data.order !== null) {\n            this.order = response.data.order;\n            this.checkCouponCode();\n            this.calcSubtotal();\n          } else if (response.data.order === null) {\n            this.searchMessage = true;\n          }\n        })\n        .catch((error) => {\n          throw new Error(error);\n        });\n    },\n    checkCouponCode() {\n      const item = this.order.products[Object.keys(this.order.products)[0]];\n      if (item.coupon) {\n        this.isUseCoupon = true;\n        this.couponCode = item.coupon.code;\n        this.couponPercent = item.coupon.percent;\n      } else if (!item.coupon) {\n        this.isUseCoupon = false;\n        this.couponCode = '';\n        this.couponPercent = 100;\n      }\n    },\n    calcSubtotal() {\n      let subTotal = 0;\n      Object.keys(this.order.products).forEach((key) => {\n        subTotal += this.order.products[key].total;\n      });\n      this.subTotal = subTotal;\n    },\n    payOrder() {\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/pay/${this.orderId}`;\n      status.isLoading = true;\n      axios\n        .post(api)\n        .then((response) => {\n          status.isLoading = false;\n          const { message } = response.data;\n          if (response.data.success) {\n            status.pushMessage({ title: message });\n            this.orderIsPaid = true;\n            this.router.push({ name: 'orderComplete' });\n          } else if (!response.data.success) {\n            status.pushMessage({ title: message, style: 'danger' });\n          }\n        })\n        .catch((error) => {\n          throw new Error(error);\n        });\n    },\n    checkCreditNum(numLength) {\n      if (numLength !== 16 && numLength >= 1) {\n        this.creditNumError = true;\n      }\n    },\n    checkCvvNum(numLength) {\n      if (numLength < 3 && numLength >= 1) {\n        this.cvvNumError = true;\n      }\n    },\n    checkAccNum(numLength) {\n      if (numLength < 5 && numLength >= 1) {\n        this.accNumError = true;\n      }\n    },\n    clearErrorMessage() {\n      this.creditNumError = false;\n      this.cvvNumError = false;\n      this.accNumError = false;\n    },\n    clearSearchMessage() {\n      this.searchMessage = false;\n    },\n    async copyOrderNumber() {\n      const orderNumber = this.order.id;\n      try {\n        if (navigator?.clipboard?.writeText && orderNumber !== '') {\n          await navigator.clipboard.writeText(orderNumber);\n          status.pushMessage({ title: '訂單號碼複製成功' });\n        } else {\n          status.pushMessage({ title: '無法複製', style: 'danger' });\n        }\n      } catch (error) {\n        throw new Error(error);\n      }\n    },\n  },\n});\n","import { defineStore } from 'pinia';\n\nexport default defineStore('statusStore', {\n  state: () => ({\n    isLoading: false,\n    cartLoadingItem: '',\n    messages: [],\n  }),\n  actions: {\n    pushMessage(data) {\n      const { title, content, style = 'success' } = data;\n      this.messages.push({ title, content, style });\n    },\n  },\n});\n","<template>\n  <div class=\"container pt-5\">\n    <h3 class=\"text-white permanent-marker text-center pt-5\">Search Order</h3>\n    <div class=\"row d-flex justify-content-center align-items-center\" style=\"height: 40vh\">\n      <div class=\"col-8\">\n        <h5 class=\"text-white\">查詢訂單</h5>\n        <form role=\"search\">\n          <div class=\"d-flex\">\n            <input\n              class=\"form-control me-2\"\n              type=\"search\"\n              id=\"search\"\n              name=\"search\"\n              placeholder=\"輸入訂單號碼\"\n              aria-label=\"Search\"\n              @focus=\"clearSearchMessage\"\n              v-model=\"orderNumber\"\n            />\n            <button\n              type=\"button\"\n              id=\"searchBtn\"\n              class=\"btn btn-outline-warning\"\n              @click.prevent=\"getOrder(orderNumber), clearSearchMessage\"\n            >\n              Search\n            </button>\n          </div>\n          <span v-if=\"searchMessage\" class=\"text-danger\">沒有訂單資料</span>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'pinia';\nimport orderStore from '@/stores/orderStore';\n\nexport default {\n  computed: {\n    ...mapState(orderStore, ['searchMessage', 'order']),\n  },\n  watch: {\n    order() {\n      if (this.order !== null) {\n        this.goToOrder();\n      }\n    },\n  },\n  data() {\n    return {\n      orderNumber: '',\n    };\n  },\n  methods: {\n    ...mapActions(orderStore, ['getOrder', 'clearSearchMessage']),\n\n    goToOrder() {\n      this.$router.push(`/user/checkout/${this.order.id}`);\n    },\n  },\n};\n</script>\n","import { render } from \"./UserOrderSearch.vue?vue&type=template&id=06b5b803\"\nimport script from \"./UserOrderSearch.vue?vue&type=script&lang=js\"\nexport * from \"./UserOrderSearch.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/san/Documents/Hex School/4. Vue/Final_Project/online-shop/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["status","statusStore","defineStore","state","orders","orderIsPaid","orderId","order","user","shippingFee","isUseCoupon","couponCode","couponPercent","subTotal","creditNumError","cvvNumError","accNumError","searchMessage","actions","getOrder","this","api","isLoading","axios","then","response","data","success","checkCouponCode","calcSubtotal","catch","error","Error","item","products","Object","keys","coupon","code","percent","forEach","key","total","payOrder","message","pushMessage","title","router","push","name","style","checkCreditNum","numLength","checkCvvNum","checkAccNum","clearErrorMessage","clearSearchMessage","async","orderNumber","id","navigator","clipboard","writeText","cartLoadingItem","messages","content","class","_createElementVNode","role","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","type","placeholder","onFocus","_cache","args","_ctx","$data","$event","onClick","_withModifiers","_hoisted_8","computed","mapState","orderStore","watch","goToOrder","methods","mapActions","$router","__exports__","render"],"sourceRoot":""}