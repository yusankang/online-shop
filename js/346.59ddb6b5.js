"use strict";(self["webpackChunkonline_shop"]=self["webpackChunkonline_shop"]||[]).push([[346],{4677:function(t,e,s){var a=s(9876),o=s(6154),i=s(6294);const r=(0,i.Z)();e["Z"]=(0,a.Q_)("cartStore",{state:()=>({cart:{},isUseCoupon:!1,couponPercent:100,couponCode:"",shippingFee:100,message:"",couponMessage:"",itemId:""}),actions:{getCart(){const t="https://vue3-course-api.hexschool.io/api/yusan-api/cart";r.isLoading=!0,o.Z.get(t).then((t=>{r.isLoading=!1,this.cart=t.data.data,this.checkCouponCode(),localStorage.setItem("cart",JSON.stringify(this.cart))})).catch((t=>{throw new Error(t)}))},checkQty(t,e){let s=t.qty;this.message="",this.itemId="","add"===e&&s>=1&&s<20?(s+=1,this.updateCart(t,s)):"subtract"===e&&s>1&&s<=20?(s-=1,this.updateCart(t,s)):"add"===e&&20===s?(this.itemId=t.id,this.message="最多數量限20"):"subtract"===e&&1===s&&(this.itemId=t.id,this.message="最少數量限1")},updateCart(t,e){const s=`https://vue3-course-api.hexschool.io/api/yusan-api/cart/${t.id}`;r.isLoading=!0,r.cartLoadingItem=t.id;const a={product_id:t.product.id,qty:e};o.Z.put(s,{data:a}).then((()=>{r.isLoading=!1,r.cartLoadingItem="",this.getCart()})).catch((t=>{throw new Error(t.data.message)}))},addCart(t,e){const s="https://vue3-course-api.hexschool.io/api/yusan-api/cart/";r.cartLoadingItem=t;const a={product_id:t,qty:1};a.qty=e,o.Z.post(s,{data:a}).then((()=>{r.cartLoadingItem="",r.pushMessage({title:"加入購物車"}),this.isUseCoupon&&this.addCouponCode(this.couponCode),this.getCart()})).catch((t=>{throw new Error(t.data.message)}))},deleteItem(t){const e=`https://vue3-course-api.hexschool.io/api/yusan-api/cart/${t.id}`;r.isLoading=!0,o.Z["delete"](e).then((t=>{const{message:e}=t.data;r.isLoading=!1,t.data.success?(r.pushMessage({title:"刪除品項"}),this.getCart()):t.data.success||r.pushMessage({title:e,style:"danger"})})).catch((t=>{throw new Error(t)}))},deleteCart(){const t="https://vue3-course-api.hexschool.io/api/yusan-api/carts";r.isLoading=!0,this.message="",o.Z["delete"](t).then((t=>{const{message:e}=t.data;r.isLoading=!1,t.data.success?(r.pushMessage({title:`購物車${e}`}),this.getCart()):t.data.success||r.pushMessage({title:e,style:"danger"})})).catch((t=>{throw new Error(t)}))},addCouponCode(t){if(""===t)this.couponMessage="請輸入優惠碼";else{const e="https://vue3-course-api.hexschool.io/api/yusan-api/coupon",s={code:t};r.isLoading=!0,o.Z.post(e,{data:s}).then((t=>{r.isLoading=!1,t.data.success?(this.CouponMessage="",this.getCart()):t.data.success||(this.couponMessage=t.data.message)})).catch((t=>{throw new Error(t)}))}},clearMessage(){this.couponMessage=""},checkCouponCode(){this.cart.carts[0]?this.cart.carts[0].coupon?(this.isUseCoupon=!0,this.couponCode=this.cart.carts[0].coupon.code,this.couponPercent=this.cart.carts[0].coupon.percent):this.cart.carts[0].coupon||(this.isUseCoupon=!1,this.couponCode="",this.couponPercent=100):this.cart.carts[0]||(this.isUseCoupon=!1,this.couponCode="",this.couponPercent=100)}}})},7012:function(t,e,s){s(7658);var a=s(9876),o=s(6154),i=s(6294);const r=(0,i.Z)();e["Z"]=(0,a.Q_)("productsStore",{state:()=>({allProducts:[],filteredProducts:[],displayProducts:[],product:{},paginationLimit:12,category:"",item:{}}),actions:{async getProducts(){const t="https://vue3-course-api.hexschool.io/api/yusan-api/products/all";r.isLoading=!0;try{const e=await o.Z.get(t);r.isLoading=!1,this.allProducts=e.data.products,this.filterCategory()}catch(e){throw new Error(e)}},setCategory(t){localStorage.setItem("currentCategory",JSON.stringify(t))},filterCategory(){this.category=JSON.parse(localStorage.getItem("currentCategory")),"all"!==this.category&&"sale"!==this.category?this.filteredProducts=this.allProducts.filter((t=>t.category===this.category)):"sale"===this.category?this.filteredProducts=this.allProducts.filter((t=>t.origin_price>t.price)):this.filteredProducts=this.allProducts,this.setCurrentPage(1)},setCurrentPage(t){this.displayProducts=[];const e=(t-1)*this.paginationLimit,s=t*this.paginationLimit;this.filteredProducts.forEach(((t,a)=>{a>=e&&a<s&&this.displayProducts.push(t)}))},async getProduct(t){const e=`https://vue3-course-api.hexschool.io/api/yusan-api/product/${t}`;r.isLoading=!0;try{const t=await o.Z.get(e);r.isLoading=!1,this.product=t.data.product}catch(s){throw new Error(s)}},scrollToTop(){window.scrollTo({top:0,left:0,behavior:"smooth"})}}})},1629:function(t,e,s){s.d(e,{Z:function(){return u}});var a=s(6252),o=s(3577);const i={class:"progress-wrapper d-flex justify-content-between my-5"},r={class:"progress-counter"};function n(t,e,s,n,c,l){return(0,a.wg)(),(0,a.iD)("div",i,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(4,(t=>(0,a._)("div",{class:(0,o.C_)(["progress-item",{completed:t<=s.progressBar}]),key:t},[(0,a._)("div",r,(0,o.zw)(t),1)],2))),64))])}var c={props:{progressBar:{type:Number,required:!0,detault:1}}},l=s(3744);const d=(0,l.Z)(c,[["render",n]]);var u=d},7657:function(t,e,s){s.d(e,{Z:function(){return dt}});var a=s(6252),o=s(3577),i=s(9963);const r={class:"card-body border-0"},n={key:0,class:"text-center mb-3"},c={key:1,class:"text-center mb-3"},l={class:"table table-sm align-middle"},d={class:"table-group-divider"},u={style:{width:"90px"},class:"ps-0"},p=["src"],g={class:"py-3"},h={class:"d-flex justify-content-between align-items-center"},y={class:"fs-6 mt-2"},m=["onClick"],w=(0,a._)("i",{class:"bi bi-trash3",style:{"font-size":"22px"}},null,-1),b=[w],_={class:"d-flex justify-content-between align-items-center"},f={key:0},C={key:0},k={for:"qty",class:"input-group input-group-sm my-2"},v=["onClick"],x=(0,a._)("i",{class:"bi bi-dash"},null,-1),D=[x],M=["onUpdate:modelValue"],q={class:"input-group-text"},I=["onClick"],L=(0,a._)("i",{class:"bi bi-plus"},null,-1),$=[L],z={class:"d-flex justify-content-between"},Z={key:0,class:"text-danger"},P={class:"row g-0"},U={class:"col-4",style:{"max-height":"200px"}},N=["src"],T={class:"col-8"},E={class:"card-body"},Q={class:"d-flex justify-content-between align-items-center"},S={class:"card-title"},j=["onClick"],H=(0,a._)("i",{class:"bi bi-trash3",style:{"font-size":"22px"}},null,-1),F=[H],K={class:"card-text"},O={for:"qty",class:"input-group input-group-sm mb-3"},V=["onClick"],Y=(0,a._)("i",{class:"bi bi-dash"},null,-1),W=[Y],J=["onUpdate:modelValue"],B={class:"input-group-text"},A=["onClick"],G=(0,a._)("i",{class:"bi bi-plus"},null,-1),R=[G],X={class:"d-flex justify-content-between"},tt={class:"d-block"},et={key:0,class:"text-danger"};function st(t,e,s,w,x,L){const H=(0,a.up)("LoadingOverlay"),Y=(0,a.up)("DeleteModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(H,{active:t.isLoading},null,8,["active"]),t.cart.final_total>0?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,o.C_)(["card border-0",{"d-md-none":1===s.progress}])},[(0,a._)("div",r,[1===s.progress?((0,a.wg)(),(0,a.iD)("h5",n,"購物車品項")):((0,a.wg)(),(0,a.iD)("h5",c,"訂單品項")),(0,a._)("table",l,[(0,a._)("tbody",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.cart.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",u,[(0,a._)("img",{src:e.product.imageUrl,alt:"product image",class:"img-fluid"},null,8,p)]),(0,a._)("td",g,[(0,a._)("div",h,[(0,a._)("h5",y,[(0,a._)("strong",null,(0,o.zw)(e.product.title),1)]),1===s.progress?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-sm text-warning p-0",onClick:t=>L.openDeleteModal(e),style:{width:"44px",height:"44px"}},b,8,m)):(0,a.kq)("",!0)]),(0,a._)("div",_,[(0,a._)("span",null,"單價 $"+(0,o.zw)(t.$filters.currency(e.product.price)),1),s.progress>1?((0,a.wg)(),(0,a.iD)("div",f,(0,o.zw)(e.qty)+"/"+(0,o.zw)(e.product.unit),1)):(0,a.kq)("",!0)]),1===s.progress?((0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("label",k,[(0,a._)("button",{class:"btn btn-outline-warning",type:"button",onClick:(0,i.iM)((s=>t.checkQty(e,"subtract")),["prevent"])},D,8,v),(0,a.wy)((0,a._)("input",{type:"text",id:"qty",class:"form-control bg-white","onUpdate:modelValue":t=>e.qty=t,disabled:""},null,8,M),[[i.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",q,"/ "+(0,o.zw)(e.product.unit),1),(0,a._)("button",{class:"btn btn-outline-warning",type:"button",onClick:(0,i.iM)((s=>t.checkQty(e,"add")),["prevent"])},$,8,I)])])):(0,a.kq)("",!0),(0,a._)("div",z,[(0,a._)("strong",null,"$"+(0,o.zw)(t.$filters.currency(e.total)),1),t.message&&t.itemId===e.id?((0,a.wg)(),(0,a.iD)("span",Z,(0,o.zw)(t.message)+(0,o.zw)(e.product.unit),1)):(0,a.kq)("",!0)])])])))),128))])])])],2)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.cart.carts,(e=>((0,a.wg)(),(0,a.iD)("div",{class:(0,o.C_)(["card mb-3 d-none border-0",{"d-md-block":1===s.progress}]),key:e.id},[(0,a._)("div",P,[(0,a._)("div",U,[(0,a._)("img",{src:e.product.imageUrl,alt:"product image",class:"rounded-start h-100 w-100",style:{"object-fit":"cover"}},null,8,N)]),(0,a._)("div",T,[(0,a._)("div",E,[(0,a._)("div",Q,[(0,a._)("h5",S,(0,o.zw)(e.product.title),1),(0,a._)("button",{type:"button",class:"btn btn-sm text-warning border-0",onClick:t=>L.openDeleteModal(e),style:{width:"44px",height:"44px"}},F,8,j)]),(0,a._)("p",K,"單價 $"+(0,o.zw)(t.$filters.currency(e.product.price)),1),(0,a._)("label",O,[(0,a._)("button",{class:"btn btn-outline-warning",type:"button",onClick:(0,i.iM)((s=>t.checkQty(e,"subtract")),["prevent"])},W,8,V),(0,a.wy)((0,a._)("input",{type:"text",id:"qty",class:"form-control bg-white","onUpdate:modelValue":t=>e.qty=t,disabled:""},null,8,J),[[i.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",B,"/ "+(0,o.zw)(e.product.unit),1),(0,a._)("button",{class:"btn btn-outline-warning",type:"button",onClick:(0,i.iM)((s=>t.checkQty(e,"add")),["prevent"])},R,8,A)]),(0,a._)("div",X,[(0,a._)("strong",tt,"$"+(0,o.zw)(t.$filters.currency(e.total)),1),t.message&&t.itemId===e.id?((0,a.wg)(),(0,a.iD)("span",et,(0,o.zw)(t.message)+(0,o.zw)(e.product.unit),1)):(0,a.kq)("",!0)])])])])],2)))),128)),(0,a.Wm)(Y,{ref:"deleteModal","selected-item":x.tempItem,onDeleteItem:t.deleteItem,onHideDeleteModal:L.hideDeleteModal},null,8,["selected-item","onDeleteItem","onHideDeleteModal"])],64)}var at=s(9876),ot=s(4677),it=s(6294),rt=s(968),nt={components:{DeleteModal:rt.Z},props:{progress:{type:Number,required:!0,default:1}},computed:{...(0,at.rn)(ot.Z,["cart","message","itemId"]),...(0,at.rn)(it.Z,["isLoading","cartLoadingItem","pushMessage"])},data(){return{tempItem:{}}},methods:{...(0,at.nv)(ot.Z,["getCart","checkQty","deleteCart","deleteItem"]),openDeleteModal(t){this.tempItem=t;const e=this.$refs.deleteModal;e.showModal()},hideDeleteModal(){const t=this.$refs.deleteModal;t.hideModal()}},created(){this.getCart()}},ct=s(3744);const lt=(0,ct.Z)(nt,[["render",st]]);var dt=lt},9628:function(t,e,s){s.d(e,{Z:function(){return K}});var a=s(6252),o=s(3577),i=s(9963);const r={key:0,class:"card-body border-0"},n=(0,a._)("h5",{class:"text-center card-title mb-3"},"訂單價格",-1),c={class:"w-100 mb-3"},l=(0,a._)("th",null,"小計",-1),d={class:"text-end"},u={key:0},p={class:"text-success"},g={class:"text-success text-end"},h={key:1},y=(0,a._)("th",{class:"text-success"},"折扣價",-1),m={class:"text-success text-end"},w={key:2},b=(0,a._)("th",null,"運費",-1),_={class:"text-end"},f={key:3},C=(0,a._)("th",null,"運費",-1),k=(0,a._)("td",{class:"text-end"},"已達到免運金額",-1),v=[C,k],x={class:"table-group-divider"},D=(0,a._)("th",null,"總計",-1),M={key:0,class:"text-end"},q={key:1,class:"text-end"},I={key:2,class:"text-end"},L={key:3,class:"text-end"},$={key:0},z={colspan:"2"},Z={class:"input-group my-3"},P={key:0,class:"text-danger"},U=(0,a._)("p",{class:"text-center"},"訂單滿$2,000免運！",-1),N={key:0,class:"d-grid"};function T(t,e,s,C,k,T){const E=(0,a.up)("LoadingOverlay"),Q=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(E,{active:t.isLoading},null,8,["active"]),t.cart.final_total>0?((0,a.wg)(),(0,a.iD)("div",r,[n,(0,a._)("table",c,[(0,a._)("tbody",null,[(0,a._)("tr",null,[l,(0,a._)("td",d,"$ "+(0,o.zw)(t.$filters.currency(t.cart.total))+" NTD",1)]),t.isUseCoupon?((0,a.wg)(),(0,a.iD)("tr",u,[(0,a._)("td",p,"已套用優惠卷 '"+(0,o.zw)(t.couponCode)+"'",1),(0,a._)("td",g,(0,o.zw)(t.couponPercent/10)+" 折",1)])):(0,a.kq)("",!0),t.cart.final_total!==t.cart.total?((0,a.wg)(),(0,a.iD)("tr",h,[y,(0,a._)("td",m,"$"+(0,o.zw)(t.$filters.currency(t.cart.final_total))+" NTD",1)])):(0,a.kq)("",!0),t.cart.final_total>0&&t.cart.final_total<2e3?((0,a.wg)(),(0,a.iD)("tr",w,[b,(0,a._)("td",_,"$"+(0,o.zw)(t.shippingFee)+" NTD",1)])):(0,a.kq)("",!0),t.cart.final_total>=2e3?((0,a.wg)(),(0,a.iD)("tr",f,v)):(0,a.kq)("",!0)]),(0,a._)("tfoot",x,[(0,a._)("tr",null,[D,t.cart.final_total!==t.cart.total&&t.cart.final_total>=2e3?((0,a.wg)(),(0,a.iD)("td",M," $"+(0,o.zw)(t.$filters.currency(t.cart.final_total))+" NTD ",1)):(0,a.kq)("",!0),t.cart.final_total!==t.cart.total&&t.cart.final_total<2e3?((0,a.wg)(),(0,a.iD)("td",q," $"+(0,o.zw)(t.$filters.currency(t.cart.final_total+t.shippingFee))+" NTD ",1)):(0,a.kq)("",!0),t.cart.final_total===t.cart.total&&t.cart.final_total>=2e3?((0,a.wg)(),(0,a.iD)("td",I," $"+(0,o.zw)(t.$filters.currency(t.cart.final_total))+" NTD ",1)):(0,a.kq)("",!0),t.cart.final_total===t.cart.total&&t.cart.final_total<2e3?((0,a.wg)(),(0,a.iD)("td",L," $"+(0,o.zw)(t.$filters.currency(t.cart.final_total+t.shippingFee))+" NTD ",1)):(0,a.kq)("",!0)]),1!==s.progress||t.isUseCoupon?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("tr",$,[(0,a._)("td",z,[(0,a._)("div",Z,[(0,a.wy)((0,a._)("input",{type:"text",id:"couponInput",class:"form-control",placeholder:"輸入優惠碼",maxlength:"20","aria-label":"Coupon code","aria-describedby":"coupon-button","onUpdate:modelValue":e[0]||(e[0]=t=>k.couponCodeInput=t),onKeyup:e[1]||(e[1]=(0,i.D2)((t=>t.target.blur()),["enter"])),onKeydown:e[2]||(e[2]=(0,i.D2)((e=>t.addCouponCode(k.couponCodeInput)),["enter"])),onFocus:e[3]||(e[3]=(...e)=>t.clearMessage&&t.clearMessage(...e)),autocomplete:"off"},null,544),[[i.nr,k.couponCodeInput]]),(0,a._)("button",{class:"btn btn-outline-secondary",type:"button",id:"coupon-button",onClick:e[4]||(e[4]=e=>t.addCouponCode(k.couponCodeInput))}," 套用優惠碼 ")]),t.couponMessage?((0,a.wg)(),(0,a.iD)("span",P,(0,o.zw)(t.couponMessage),1)):(0,a.kq)("",!0)])]))])]),U,1===s.progress?((0,a.wg)(),(0,a.iD)("div",N,[(0,a.Wm)(Q,{to:"/user/orderform",class:"btn btn-warning"},{default:(0,a.w5)((()=>[(0,a.Uk)("結帳")])),_:1})])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)],64)}var E=s(9876),Q=s(4677),S=s(6294),j={props:{progress:{type:Number,required:!0}},computed:{...(0,E.rn)(Q.Z,["cart","isUseCoupon","couponPercent","couponCode","couponMessage","shippingFee"]),...(0,E.rn)(S.Z,["isLoading","cartLoadingItem","pushMessage"])},data(){return{couponCodeInput:""}},methods:{...(0,E.nv)(Q.Z,["getCart","addCouponCode","clearMessage"])}},H=s(3744);const F=(0,H.Z)(j,[["render",T]]);var K=F}}]);
//# sourceMappingURL=346.59ddb6b5.js.map