"use strict";(self["webpackChunkonline_shop"]=self["webpackChunkonline_shop"]||[]).push([[123],{646:function(e,r,s){s(7658);var t=s(9876),o=s(6154),c=s(6294);const a=(0,c.Z)();r["Z"]=(0,t.Q_)("orderStore",{state:()=>({orders:[],orderIsPaid:!1,orderId:"",order:{user:{}},shippingFee:100,isUseCoupon:!1,couponCode:"",couponPercent:100,subTotal:0,creditNumError:!1,cvvNumError:!1,accNumError:!1,searchMessage:!1}),actions:{getOrder(e){this.orderId=e;const r=`https://vue3-course-api.hexschool.io/api/yusan-api/order/${e}`;a.isLoading=!0,o.Z.get(r).then((e=>{a.isLoading=!1,e.data.success&&null!==e.data.order?(this.order=e.data.order,this.checkCouponCode(),this.calcSubtotal()):null===e.data.order&&(this.searchMessage=!0)})).catch((e=>{throw new Error(e)}))},checkCouponCode(){const e=this.order.products[Object.keys(this.order.products)[0]];e.coupon?(this.isUseCoupon=!0,this.couponCode=e.coupon.code,this.couponPercent=e.coupon.percent):e.coupon||(this.isUseCoupon=!1,this.couponCode="",this.couponPercent=100)},calcSubtotal(){let e=0;Object.keys(this.order.products).forEach((r=>{e+=this.order.products[r].total})),this.subTotal=e},payOrder(){const e=`https://vue3-course-api.hexschool.io/api/yusan-api/pay/${this.orderId}`;a.isLoading=!0,o.Z.post(e).then((e=>{a.isLoading=!1;const{message:r}=e.data;e.data.success?(a.pushMessage({title:r}),this.orderIsPaid=!0,this.router.push({name:"orderComplete"})):e.data.success||a.pushMessage({title:r,style:"danger"})})).catch((e=>{throw new Error(e)}))},checkCreditNum(e){16!==e&&e>=1&&(this.creditNumError=!0)},checkCvvNum(e){e<3&&e>=1&&(this.cvvNumError=!0)},checkAccNum(e){e<5&&e>=1&&(this.accNumError=!0)},clearErrorMessage(){this.creditNumError=!1,this.cvvNumError=!1,this.accNumError=!1},clearSearchMessage(){this.searchMessage=!1}}})},6294:function(e,r,s){s(7658);var t=s(9876);r["Z"]=(0,t.Q_)("statusStore",{state:()=>({isLoading:!1,cartLoadingItem:"",messages:[]}),actions:{pushMessage(e){const{title:r,content:s,style:t="success"}=e;this.messages.push({title:r,content:s,style:t})}}})},1123:function(e,r,s){s.r(r),s.d(r,{default:function(){return C}});var t=s(6252),o=s(9963);const c={class:"container pt-5"},a=(0,t._)("h3",{class:"text-white permanent-marker text-center pt-5"},"Search Order",-1),n={class:"row d-flex justify-content-center align-items-center",style:{height:"40vh"}},i={class:"col-8"},h=(0,t._)("h5",{class:"text-white"},"查詢訂單",-1),u={role:"search"},d={class:"d-flex"},l={key:0,class:"text-danger"};function p(e,r,s,p,g,m){return(0,t.wg)(),(0,t.iD)("div",c,[a,(0,t._)("div",n,[(0,t._)("div",i,[h,(0,t._)("form",u,[(0,t._)("div",d,[(0,t.wy)((0,t._)("input",{class:"form-control me-2",type:"search",id:"search",name:"search",placeholder:"輸入訂單號碼","aria-label":"Search",onFocus:r[0]||(r[0]=(...r)=>e.clearSearchMessage&&e.clearSearchMessage(...r)),"onUpdate:modelValue":r[1]||(r[1]=e=>g.orderNumber=e)},null,544),[[o.nr,g.orderNumber]]),(0,t._)("button",{type:"button",id:"searchBtn",class:"btn btn-outline-warning",onClick:r[2]||(r[2]=(0,o.iM)((r=>(e.getOrder(g.orderNumber),e.clearSearchMessage)),["prevent"]))}," Search ")]),e.searchMessage?((0,t.wg)(),(0,t.iD)("span",l,"沒有訂單資料")):(0,t.kq)("",!0)])])])])}s(7658);var g=s(9876),m=s(646),v={computed:{...(0,g.rn)(m.Z,["searchMessage","order"])},watch:{order(){null!==this.order&&this.goToOrder()}},data(){return{orderNumber:""}},methods:{...(0,g.nv)(m.Z,["getOrder","clearSearchMessage"]),goToOrder(){this.$router.push(`/user/checkout/${this.order.id}`)}}},b=s(3744);const k=(0,b.Z)(v,[["render",p]]);var C=k}}]);
//# sourceMappingURL=123.bd6899fb.js.map